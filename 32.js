(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"7hs+":function(t,e,a){"use strict";a.r(e),a.d(e,"EvaluatePapersChairSecModule",function(){return h});var o=a("mrSG"),n=a("fXoL"),s=a("ofXK"),i=a("tyNb"),l=a("TJ9D"),r=a("5zbU");let d=class{constructor(t,e){this.paperService=t,this.evaluationService=e,this.edit=!1,this.articulos=[],this.vectorArticulos=[],this.detailed=!1,this.index=0,this.observacionAutor="",this.detalles=[],this.detNombreArticulo="",this.detEstado={id:0,nombre:""},this.detEvUno={id:0,nombre:"Evaluador 1"},this.detEvDos={id:0,nombre:"Evaluador 2"},this.detEvTres={id:0,nombre:"Evaluador 3"},this.puntuaciones=[{value:0,nombre:""},{value:1,nombre:"Muy D\xe9bil"},{value:2,nombre:"D\xe9bil"},{value:3,nombre:"Aceptable"},{value:4,nombre:"Bueno"},{value:5,nombre:"Muy bueno"}]}ngOnInit(){this.getArticulos()}evaluarDetalle(t){const e=document.getElementById("selectStateDetalle"),a=e.options[e.selectedIndex].value;if(""!==a){const e=parseInt(a,10);this.evaluar(t,e)}else document.getElementById("selectStateDetalle").classList.add("is-invalid")}evaluar(t,e){let a=this.vectorArticulos[t].idEstado,o=!1;a>=5&&(o=!0),1===e&&o?a=8:2===e&&o?a=9:1===e?a=6:2===e?a=7:3===e&&(a=5);const n=this.vectorArticulos[t].id,s=a,i=document.getElementById("observacion-autor");this.observacionAutor=i.value,this.articulos[t].observacion=i.value,this.vectorArticulos[t].observacion=i.value,this.paperService.calificarPaper(n,s,this.observacionAutor).subscribe(e=>{document.getElementById("selectStateDetalle").value="",this.setBadges(t,s),this.toggleEdit(t)})}setBadges(t,e){return 6===e?(this.vectorArticulos[t].idEstado=e,this.vectorArticulos[t].estado="Aprobado",this.detEstado.id=6,void(this.detEstado.nombre="Aprobado")):7===e?(this.vectorArticulos[t].idEstado=e,this.vectorArticulos[t].estado="Rechazado",this.detEstado.id=7,void(this.detEstado.nombre="Rechazado")):5===e?(this.vectorArticulos[t].idEstado=e,this.vectorArticulos[t].estado="Para Reentregar",this.detEstado.id=5,void(this.detEstado.nombre="Para Reentregar")):8===e?(this.vectorArticulos[t].idEstado=e,this.vectorArticulos[t].estado="Aprobado Reentrega",this.detEstado.id=8,void(this.detEstado.nombre="Aprobado Reentrega")):9===e?(this.vectorArticulos[t].idEstado=9,this.vectorArticulos[t].estado="Rechazado Reentrega",this.detEstado.id=9,void(this.detEstado.nombre="Rechazado Reentrega")):void 0}verDetalle(t){this.index=t,this.detEvUno.nombre="Evaluador 1",this.detEvDos.nombre="Evaluador 2",this.detEvTres.nombre="Evaluador 3";const e=this.vectorArticulos[t],a=e.evaluaciones;this.detNombreArticulo=e.nombre;document.getElementById("observacion-autor").value=e.observacion,this.observacionAutor=e.observacion,this.detEstado.id=e.idEstado,this.detEstado.nombre=e.estado,a.length>=1&&(this.detEvUno.id=a[0].idEvaluador,this.detEvUno.nombre=a[0].evaluador),a.length>=2&&(this.detEvDos.id=a[1].idEvaluador,this.detEvDos.nombre=a[1].evaluador),a.length>=3&&(this.detEvTres.id=a[2].idEvaluador,this.detEvTres.nombre=a[2].evaluador),this.evaluationService.getItemsEvaluacion(1).subscribe(a=>{const o=a.data;this.paperService.getEvaluationDetails(e.id).subscribe(e=>{let a,n,s;e.data.forEach(t=>{t.idEvaluador===this.detEvUno.id?a=t:t.idEvaluador===this.detEvDos.id?n=t:s=t});let i=null,l=null,r=null,d=null,c=null,u=null,v=null,b=null,h=null,p=null,m=null,E=null;for(let t=0;t<o.length;t++)i=void 0!==a&&void 0!==a.itemsEvaluados[t]?a.itemsEvaluados[t].calificacion:0,l=void 0!==n&&void 0!==n.itemsEvaluados[t]?n.itemsEvaluados[t].calificacion:0,r=void 0!==s&&void 0!==s.itemsEvaluados[t]?s.itemsEvaluados[t].calificacion:0,this.detalles.push({aspecto:o[t].nombre,res1:this.puntuaciones[i].nombre,res2:this.puntuaciones[l].nombre,res3:this.puntuaciones[r].nombre}),i=null,l=null,r=null;void 0!==this.vectorArticulos[t].evaluaciones[0]?(d=this.vectorArticulos[t].evaluaciones[0].recomendacion,v=this.vectorArticulos[t].evaluaciones[0].observacion,p=this.vectorArticulos[t].evaluaciones[0].observacionInterna):(d=null,v=null,p=null),void 0!==this.vectorArticulos[t].evaluaciones[1]?(c=this.vectorArticulos[t].evaluaciones[1].recomendacion,b=this.vectorArticulos[t].evaluaciones[1].observacion,m=this.vectorArticulos[t].evaluaciones[1].observacionInterna):(c=null,b=null,m=null),void 0!==this.vectorArticulos[t].evaluaciones[2]?(u=this.vectorArticulos[t].evaluaciones[2].recomendacion,h=this.vectorArticulos[t].evaluaciones[2].observacion,E=this.vectorArticulos[t].evaluaciones[2].observacionInterna):(u=null,h=null,E=null),this.detalles.push({aspecto:"Recomendaci\xf3n",res1:d,res2:c,res3:u}),this.detalles.push({aspecto:"Observaci\xf3n para el Autor",res1:v,res2:b,res3:h}),this.detalles.push({aspecto:"Observaci\xf3n Interna",res1:p,res2:m,res3:E})})});document.getElementById("activar-modal").click()}getArchivo(t){const e=this.vectorArticulos[t].id;this.paperService.getPaperFile(e).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"}),a=window.URL.createObjectURL(e),o=document.createElement("a");void 0!==o.download&&(o.setAttribute("href",a),o.setAttribute("target","_blank"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o))})}getArticulos(){this.articulos=[],this.paperService.getPapersXChair().subscribe(t=>{const e=t.data[0].articulos;this.articulos=e,this.sortByState(),this.articulos=this.articulos.map(t=>({estado:t.estado,evaluaciones:t.evaluaciones,id:t.id,idCongreso:t.idCongreso,idEstado:t.idEstado,idSimposio:t.idSimposio,nombre:t.nombre,responsable:t.responsable,observacion:t.observacion,observacionInterna:t.observacionInterna,url:t.url,edit:!1})),this.vectorArticulos=this.articulos})}filter(t){if(this.vectorArticulos=[],0!==t)for(const e of this.articulos)e.idEstado===t&&this.vectorArticulos.push(e);else this.vectorArticulos=this.articulos}sortByState(){this.articulos.sort((t,e)=>t.idEstado>e.idEstado?1:t.idEstado<e.idEstado?-1:0)}modalOnClose(t){document.getElementById("selectStateDetalle").value="";document.getElementById("observacion-autor").value="",this.detalles=[],document.getElementById("selectStateDetalle").classList.remove("is-invalid"),this.vectorArticulos[t].edit=!1}toggleEdit(t){this.vectorArticulos[t].edit=!this.vectorArticulos[t].edit}};d.ctorParameters=()=>[{type:l.a},{type:r.a}],d=Object(o.c)([Object(n.o)({selector:"app-evaluate-papers-chair-sec",template:'<div class="container-fluid">\n  <div class="evaluation-cards">\n          <hr>\n          <h3 class="card-title text-center">Evaluaci\xf3n de Art\xedculos</h3>\n          <hr>\n  </div>\n  \x3c!-- Filtros --\x3e\n    <div class="row">\n      <div class="col-auto col-form-label"><label for="btn-group-filtros">Filtros</label></div>\n      <div class="btn-group col-auto" id="btn-group-filtros" role="group">\n        <button type="button" class="btn btn-outline-primary" (click)="filter(0)">Todos</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(4)">Pendiente</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(6)">Aprobados</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(7)">Rechazados</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(5)">Reentrega</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(8)">Aprobado Reentrega</button>\n        <button type="button" class="btn btn-outline-primary" (click)="filter(9)">Rechazado Reentrega</button>\n      </div>\n    </div>\n  \x3c!-- Evaluation Cards List --\x3e\n  <div *ngFor="let art of vectorArticulos; index as i">\n      <div class="card col-md-6 offset-3">\n          <div class="card-body">\n            <div class="row ">\n              <div class="col-auto me-auto">\n                <h5 class="card-title">{{art.nombre}}</h5>\n              </div>\n              <div class="col-auto">\n                <h5 class="card-title"><span class="badge bg-primary"\n                  [class.bg-warning]="art.idEstado === 5"\n                  [class.text-dark]="art.idEstado === 5"\n                  [class.bg-success]="art.idEstado === 6 || art.idEstado === 8"\n                  [class.bg-danger]="art.idEstado === 7 || art.idEstado === 9">{{art.estado}}</span></h5>\n              </div>\n            </div>\n            <div class="row">\n              <h6 class="card-subtitle mb-2 text-muted" id="evaluadores">Evaluadores:</h6>\n            </div>\n              <div *ngFor="let ev of art.evaluaciones" class="row ev-reco">\n                <div class="col col-md-3">\n                  <p id="nombreEvaluador">&nbsp;&nbsp;&nbsp;&nbsp;{{ev.evaluador}}:</p>\n                </div>\n                <div class="col col-md-3">\n                  <p class="card-text">{{ev.recomendacion}}</p>\n                </div>\n              </div>\n          </div>\n          <div class="card-footer">\n            <a class="btn  card-footer-btn" (click)="getArchivo(i)"><i class="fas fa-file-pdf"></i> Ver art\xedculo</a> \n            &nbsp; \n            <a class="btn  card-footer-btn" (click)="verDetalle(i)"><i class="fa fa-search-plus"></i> Ver detalle</a>\n            <a *ngIf="!art.edit" class="btn card-footer-btn" id="editar" (click)="toggleEdit(i)"><i class="fa fa-pencil"></i> Evaluar</a>\n            <div id="evaluation-select" *ngIf="art.edit">\n              <a class="btn btn-outline-success" *ngIf="art.idEstado !== 6 && art.idEstado !== 8" (click)="evaluar(i, 1)">Aprobar</a>\n              &nbsp;\n              <a class="btn btn-outline-danger" *ngIf="art.idEstado !== 7 && art.idEstado !== 9" (click)="evaluar(i, 2)">Rechazar</a>\n              &nbsp;\n              <a class="btn btn-outline-warning" *ngIf="art.idEstado !== 5" (click)="evaluar(i, 3)">Reentrega</a>\n              &nbsp;\n              <a class="btn btn-outline-secondary" title="Cancelar" (click)="toggleEdit(i)"><i class="fas fa-times fa-lg"></i></a>\n            </div>\n          </div>\n        </div>\n  </div>\n</div>\n\x3c!-- Evaluation Detail Modal --\x3e\n<button hidden id="activar-modal" data-bs-toggle="modal" data-bs-target="#detallesModal"></button>\n\x3c!-- Modal Detalles --\x3e\n<div class="modal fade" id="detallesModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="detallesModalLabel" aria-hidden="true">\n  <div class="modal-dialog modal-xl modal-dialog-scrollable">\n    <div class="modal-content">\n      <div class="modal-header">\n          <h5 class="modal-title" id="detallesModalLabel">\n            {{detNombreArticulo}} <span class="badge bg-primary" [class.bg-warning]="detEstado.id === 5"\n                                                                 [class.text-dark]="detEstado.id === 5"\n                                                                 [class.bg-success]="detEstado.id === 6 || detEstado.id === 8"\n                                                                 [class.bg-danger]="detEstado.id === 7 || detEstado.id === 9">{{detEstado.nombre}}</span></h5>\n          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="modalOnClose(index)"></button>\n      </div>\n      <div class="modal-body">\n        <div class="container">\n            <table class="table table-hover table-bordered">\n              <thead class="text-center">\n                <tr>\n                  <th>Aspecto</th>\n                  <th>{{detEvUno.nombre}}</th>\n                  <th>{{detEvDos.nombre}}</th>\n                  <th>{{detEvTres.nombre}}</th>\n                </tr>\n              </thead>\n              <tbody class="text-center">\n                <tr *ngFor="let det of detalles" >\n                  <td>{{det.aspecto}}</td> \x3c!-- criterio --\x3e\n                  <td>{{det.res1}}</td> \x3c!-- ev1 --\x3e\n                  <td>{{det.res2}}</td> \x3c!-- ev2 --\x3e\n                  <td>{{det.res3}}</td> \x3c!-- ev3 --\x3e\n              </tbody>\n            </table>\n            <div class="row row-detalle align-items-center">\n              <div class="col-md-3">\n                <label for="selectStateDetalle" class="col-form-label"><span id="spanEvaluacion">Evaluaci\xf3n:</span></label>\n              </div>\n              <div class="col-md-4">\n                <select class="form-select" id="selectStateDetalle">\n                  <option disabled selected value=""></option>\n                  <option value="1" *ngIf="detEstado.id !== 6 && detEstado.id !== 8">Aprobar</option>\n                  <option value="2" *ngIf="detEstado.id !== 7 && detEstado.id !== 9">Rechazar</option>\n                  <option value="3" *ngIf="detEstado.id !== 5">Necesita Reentrega</option>\n              </select>\n              </div>\n            </div>\n            <div class="row row-detalle">\n              <div class="col-md-3">\n                <label for="observacion-autor" class="col-form-label"><span id="spanEvaluacion">Observaci\xf3n para el Autor:</span></label>\n              </div>\n              <div class="col-md-8">\n                <textarea class="form-control" id="observacion-autor">{{observacionAutor}}</textarea>\n              </div>\n            </div>\n            <div class="row row-detalle">\n              <div class="col-md-3"></div>\n              <div class="col-auto">\n                <a class="btn btn-outline-success" id="btnGuardar" (click)="evaluarDetalle(index)">Guardar Evaluaci\xf3n <i class="fa fa-save fa-lg"></i></a>\n              </div>\n            </div>\n        </div>\n      </div>\n      <div class="modal-footer">\n        <div class="col-auto me-auto">\n          <a class="btn btn-primary btn-border" (click)="getArchivo(index)"><i class="fas fa-file-pdf"></i> Ver art\xedculo</a>\n        </div>\n        <div class="col-auto">\n          <button type="button" class="btn btn-secondary btn-border" data-bs-dismiss="modal" (click)="modalOnClose(index)">Cerrar</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[".container-fluid{\n    background-color: #F4F4F4;\n  \n  }\n  \nhr{\n    border:#00609C solid 1px;\n}\n  \n@media (min-width: 768px) {\n    hr{\n        margin-left: 25%;\n        margin-right: 25%;\n\n    }\n\n    .container-fluid{\n        padding: 5rem;\n    }\n}\n  \n.ev-reco {\n    margin-bottom: -15px;\n}\n  \n.evaluation-cards {\n    padding-bottom: 20px;\n}\n  \n.card {\n    margin-top: 20px;\n}\n  \n.card-footer {\n    background-color: white;\n}\n  \n.modal-header {\n    padding-left: 29px;\n    padding-right: 29px;\n}\n  \n.modal-footer {\n    padding-left: 29px;\n    padding-right: 29px;\n}\n  \n.row-detalle {\n    margin-bottom: 10px;\n}\n  \n.table {\n    margin-top: 30px;\n}\n  \n.btn-primary {\n    background-color: #00609C;\n    color: white;\n    border-color: transparent;\n}\n  \n.btn-primary:hover {\n    background-color: #0080cf;\n}\n  \n.btn-border {\n    border: none;\n}\n  \n.btn-outline-primary {\n    border-color: #00609C;\n    color: #00609C;\n}\n  \n.btn-outline-primary:hover {\n    background-color: #00609C;\n    border-color: #00609C;\n    color: white;\n}\n  \n.card-footer-btn {\n    color: #00609C;\n    background: transparent;\n    border: transparent;\n}\n  \n.card-footer-btn:hover {\n    color: #3cafe0;\n}\n  \n#selectStateDetalle {\n    float: left;\n}\n  \n#btnGuardar {\n    float: right;\n}\n  \n#evaluadores {\n    font-style: italic;\n}\n  \n#nombreEvaluador {\n    font-weight: 500;\n}\n  \n#responsable {\n    font-style: italic;\n}\n  \n#editar {\n    float: right;\n}\n  \n#evaluation-select {\n    float:right;\n}\n  \n#evaluation-select-detalle {\n    white-space:nowrap;\n}\n  \n#spanEvaluacion {\n    font-weight: 500;\n}\n"]})],d);const c=[{path:"",component:d}];let u=class{};u=Object(o.c)([Object(n.N)({imports:[i.c.forChild(c)],exports:[i.c]})],u);var v=a("pKmL"),b=a("tk/3");let h=class{};h=Object(o.c)([Object(n.N)({declarations:[d],imports:[s.c,u,v.a,b.c],schemas:[n.j]})],h)}}]);
//# sourceMappingURL=32.js.map