{"version":3,"sources":["./src/app/pages/inscriptions/inscriptions.module.ts","./src/app/pages/inscriptions/inscriptions.component.html","./src/app/pages/inscriptions/inscriptions.component.ts","./src/app/pages/inscriptions/inscriptions-routing.module.ts"],"names":[],"mappings":"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","file":"pages-inscriptions-inscriptions-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { InscriptionsRoutingModule } from './inscriptions-routing.module';\nimport { InscriptionsComponent } from './inscriptions.component';\nimport { CoreModule } from 'src/app/core/core.module';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\n\n@NgModule({\n  declarations: [\n    InscriptionsComponent\n  ],\n  imports: [\n    CommonModule,\n    InscriptionsRoutingModule,\n    CoreModule,\n    ReactiveFormsModule,\n    FormsModule,\n\n  ]\n})\nexport class InscriptionsModule { }\n","<div class=\"container-fluid\">\n  <div class=\"contenidos\">\n    <hr>\n    <h3 class='text-center'>Inscripciones</h3>\n    <hr>\n  </div>\n  <div class=\"section\">\n    <h6>Usted está a punto de inscribirse al congreso: {{congress.nombre}}\n      a desarrollarse en la sede {{congress.sede}}. Los días {{congress.fechaInicio}} a {{congress.fechaFin}}.\n    </h6>\n    <h6>\n      Por favor, complete todos los campos:\n    </h6>\n  </div>\n\n  <div class=\"accordion accordion-flush\" id=\"accordionFlushExample\">\n    <div class=\"accordion-item\">\n      <h2 class=\"accordion-header\" id=\"flush-headingOne\">\n        <button class=\"accordion-button \" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseOne\"\n          aria-expanded=\"true\" aria-controls=\"flush-collapseOne\">\n          Selecciona tu entrada\n        </button>\n      </h2>\n      <div id=\"flush-collapseOne\" class=\"accordion-collapse collapse show\" aria-labelledby=\"flush-headingOne\"\n        data-bs-parent=\"#accordionFlushExample\">\n        <div class=\"accordion-body row justify-content-center\">\n          <div class=\"col-sm-6 text-center\" *ngFor=\"let item of tarifas\">\n            <div class=\"card text-left\" [ngClass]='tarifaSelected.id === item.id ? \"marked\" : \"\" '>\n              <div class=\"card-body\">\n                <h4 class=\"card-title\">{{item.nombre}}</h4>\n                <h6 class=\"card-text\">$ {{item.precio}}</h6>\n\n                <form [formGroup]='formUsuario'>\n                  <div class=\"form-group row\">\n                    <label class=\"col-form-label col-sm-2 col-sm-offset-2\" for=\"cupon\">Tengo un cupón: <span\n                        class=\"text-danger\">*</span></label>\n                    <div class=\"col-sm-6\">\n                      <input type=\"text\" class=\"form-control\" formControlName=\"cupon\" [ngClass]=\"{'is-invalid': formUsuario.controls.cupon.errors}\" onclick=\"this.select()\" />\n                      <span class=\"text-danger\"\n                        *ngIf=\"formUsuario.controls.cupon.errors\">\n                        Cupón inválido.\n                      </span>\n                    </div>\n                  </div>\n\n                  <button type=\"button\" (click)='inscribirme(item)' class=\"btn btn-primary btn-lg btn-block\">\n                    Inscribirme\n                  </button>\n                </form>\n                <button type=\"button\" hidden class=\"btn btn-primary btn-lg btn-block\" id='go-next'\n                data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseThree\" aria-expanded=\"false\"\n                aria-controls=\"flush-collapseThree\">\n                Inscribirme\n              </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"accordion-item\">\n      <h2 class=\"accordion-header\" id=\"flush-headingThree\">\n        <button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\"\n          data-bs-target=\"#flush-collapseThree\" aria-expanded=\"false\" aria-controls=\"flush-collapseThree\">\n          Realizar el Pago\n        </button>\n      </h2>\n      <div id=\"flush-collapseThree\" class=\"accordion-collapse collapse\" aria-labelledby=\"flush-headingThree\"\n        data-bs-parent=\"#accordionFlushExample\">\n        <div class=\"accordion-body\" *ngIf=\"tarifaSelected\">\n          <div class=\"row justify-content-center\">\n            <div class=\"col-sm-6 \">\n              <div class=\"card\">\n                <div class=\"card-body text-center\">\n                  <h5 class=\"card-title\">Estas a un paso de completar tu compra!</h5>\n                  <p class=\"card-text\">¿Estas seguro que deseas la entrada \"<b>{{tarifaSelected.nombre}}</b>\"?</p>\n                  <p class=\"card-text\">El precio de la entrada es de $<b>{{tarifaSelected.precio}}</b></p>\n                  <div class=\"row justify-items-end\">\n                    <button type=\"button\" class=\"btn btn-primary btn-lg btn-block\"\n                    *ngIf=\"loading\"\n                    >\n                    <div class=\"spinner-border text-primary\" role=\"status\">\n                      <span class=\"sr-only\">Loading...</span>\n                    </div>\n                    </button>\n                    <button type=\"button\" (click)='pagar()' class=\"btn btn-primary btn-lg btn-block aling-items-end\"\n                    *ngIf=\"!loading\"\n                    >\n                      Continuar al pago\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\nimport { CongressService } from 'src/app/core/services/congress.service';\nimport { InscriptionsService } from 'src/app/core/services/inscriptions.service';\nimport { TarifasService } from 'src/app/core/services/tarifas.service';\n\n@Component({\n  selector: 'app-inscriptions',\n  templateUrl: './inscriptions.component.html',\n  styleUrls: ['./inscriptions.component.css']\n})\nexport class InscriptionsComponent implements OnInit {\n\n  idCongress = '';\n  congress = {\n      id: 1,\n      nombre: 'Prueba',\n      sede: 'FRC',\n      fechaInicio: '21/08/2022',\n      fechaFin: '25/08/2022',\n    };\n  tarifas = [ ];\n  tarifaSelected = false;\n  datosCompletos = false;\n  loading = false;\n  idInscrip = null;\n  formUsuario: FormGroup;\n  submitted = false;\n  isLinear = false;\n  constructor(private route: ActivatedRoute,\n              private formBuilder: FormBuilder,\n              private inscriptionService: InscriptionsService,\n              private router: Router,\n              private toastr: ToastrService,\n              private congressService: CongressService,\n              private tarifaService: TarifasService\n              ) { }\n\n  ngOnInit(): void {\n    window.scrollTo(0,0);\n    // El usuario si o si tiene que estar logueado. Datos mínimos.\n    this.formUsuario = this.formBuilder.group({\n      cupon: [''],\n    });\n    this.idCongress = this.route.snapshot.paramMap.get('id');\n    this.getCongresos();\n    this.getTarifas();\n  }\n\n  getCongresos(): void {\n   this.congressService.getCongressById().subscribe((res: any) => {\n    const fechaI = res.data[0].fechaInCongreso.split(' ')[0].split('/');\n    const fechaF = res.data[0].fechaFinCongreso.split(' ')[0].split('/');\n\n    const fechaIn = new Date(fechaI[2], fechaI[1] - 1, fechaI[0]);\n    const fechaFin = new Date(fechaF[2], fechaF[1] - 1, fechaF[0]);\n    this.congress = {\n      id: res.data[0].id,\n      nombre: res.data[0].nombre,\n      sede: res.data[0].nombre_sede,\n      fechaInicio: fechaIn.toLocaleDateString(),\n      fechaFin: fechaFin.toLocaleDateString(),\n    };\n   });\n  }\n\n  getTarifas(): void {\n    // Traer datos de tarifa para estudiantes / asistentes/ autores.\n    // URL : inscripciones/devolver-tarifas-activas/\n    this.tarifaService.getTarifasActivas().subscribe((res: any) => {\n      this.tarifas = res.data;\n    });\n  }\n\n  pagar(): void {\n    // Tirar el post a la BD para conseguir el preference id.\n    // post\n    this.inscriptionService.generatePreference(this.idInscrip).subscribe((res: any) => {\n      this.loading = true;\n      window.location.href = res.init_point;\n    });\n  }\n\n  inscribirme(item: any): void {\n    // Post a la BD - URL: inscripciones/crear-inscripcion/ --> idInscripción - PrecioFinal // 400 si cupón inválido\n    const cupon = this.formUsuario.controls.cupon.value;\n    this.formUsuario.controls.cupon.setErrors(null);\n    this.inscriptionService.inscribirme(cupon).subscribe((res: any) => {\n      if (res.error) {\n        this.toastr.warning('Error en la inscripción. Usted ya se encuentra inscripto o el cupón ingresado es inválido.');\n        this.formUsuario.controls.cupon.setErrors({incorrect: true});\n        return;\n      }\n      this.idInscrip = res.data.id;\n      this.tarifaSelected = {\n        ...item,\n        precio: res.data.precioFinal\n      };\n      const btnDetalle = document.getElementById('go-next');\n      btnDetalle.click();\n    });\n  }\n\n  datos(): void {\n    this.datosCompletos = false;\n    if (this.formUsuario.invalid) {\n      this.toastr.warning('Por favor complete los datos');\n      return;\n    }\n    this.datosCompletos = true;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { InscriptionsComponent } from './inscriptions.component';\n\nconst routes: Routes = [{\n  path: '',\n  component: InscriptionsComponent\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class InscriptionsRoutingModule { }\n"],"sourceRoot":"webpack:///"}