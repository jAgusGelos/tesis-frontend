(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4MWl":function(t,i,a){"use strict";a.r(i),a.d(i,"AsignarPaperEvaluadorModule",function(){return Q});var e=a("ofXK"),o=a("tyNb"),r=a("fXoL"),n=a("KaZm"),l=a("y6im"),s=a("isFk"),c=a("5eHb"),d=a("bcAm"),b=a("3Pt+");function u(t,i){1&t&&(r.Rb(0,"button",14),r.Rb(1,"div",15),r.Rb(2,"span",16),r.Jc(3,"Loading..."),r.Qb(),r.Qb(),r.Qb())}function v(t,i){if(1&t){const t=r.Sb();r.Rb(0,"a",4),r.bc("click",function(){return r.Bc(t),r.dc().post()}),r.Jc(1,"Finalizar Asignaci\xf3n"),r.Qb()}}function p(t,i){if(1&t&&(r.Rb(0,"option",22),r.Jc(1),r.Qb()),2&t){const t=i.$implicit,a=r.dc().$implicit;r.mc("value",t.idEvaluador),r.lc("selected",a.idEval1===t.idEvaluador),r.Ab(1),r.Mc("",t.nombreEv," ",t.apellidoEv,"")}}function g(t,i){if(1&t&&(r.Rb(0,"option",22),r.Jc(1),r.Qb()),2&t){const t=i.$implicit,a=r.dc().$implicit;r.mc("value",t.idEvaluador),r.lc("selected",a.idEval2===t.idEvaluador),r.Ab(1),r.Mc("",t.nombreEv," ",t.apellidoEv,"")}}function h(t,i){if(1&t&&(r.Rb(0,"option",22),r.Jc(1),r.Qb()),2&t){const t=i.$implicit,a=r.dc().$implicit;r.lc("value",t.idEvaluador)("selected",a.idEval3===t.idEvaluador),r.Ab(1),r.Mc("",t.nombreEv," ",t.apellidoEv,"")}}function m(t,i){if(1&t){const t=r.Sb();r.Rb(0,"tr",17),r.Rb(1,"td"),r.Jc(2),r.Qb(),r.Rb(3,"td"),r.Rb(4,"div",18),r.Rb(5,"select",19),r.bc("change",function(a){r.Bc(t);const e=i.$implicit;return r.dc().selectOption1(a.target.value,e)}),r.Rb(6,"option",20),r.Jc(7,"Evaluador 1"),r.Qb(),r.Hc(8,p,2,4,"option",21),r.Qb(),r.Qb(),r.Qb(),r.Rb(9,"td"),r.Rb(10,"div",18),r.Rb(11,"select",19),r.bc("change",function(a){r.Bc(t);const e=i.$implicit;return r.dc().selectOption2(a.target.value,e)}),r.Rb(12,"option",20),r.Jc(13,"Evaluador 2"),r.Qb(),r.Hc(14,g,2,4,"option",21),r.Qb(),r.Qb(),r.Qb(),r.Rb(15,"td"),r.Rb(16,"div",18),r.Rb(17,"select",19),r.bc("change",function(a){r.Bc(t);const e=i.$implicit;return r.dc().selectOption3(a.target.value,e)}),r.Rb(18,"option",20),r.Jc(19,"Evaluador 3"),r.Qb(),r.Hc(20,h,2,4,"option",21),r.Qb(),r.Qb(),r.Qb(),r.Qb()}if(2&t){const t=i.$implicit,a=r.dc();r.Ab(2),r.Kc(t.nombreArticulo),r.Ab(4),r.lc("selected",null===t.idEval1),r.Ab(2),r.lc("ngForOf",a.evaluatorList),r.Ab(4),r.lc("selected",null===t.idEval2),r.Ab(2),r.lc("ngForOf",a.evaluatorList),r.Ab(4),r.lc("selected",null===t.idEval3),r.Ab(2),r.lc("ngForOf",a.evaluatorList)}}let E=(()=>{class t{constructor(t,i,a,e){this.evaluatorService=t,this.articulosService=i,this.toastr=a,this.router=e,this.evaluatorList=[],this.idEval=0,this.assignedPaperList=[],this.showAssignedPaperList=[],this.nombreArticulo="nombreArticulo",this.loading=!1}ngOnInit(){this.getPaperList(),this.getEvaluators()}getPaperList(){this.articulosService.getPaperEvaluators().subscribe(t=>{this.paperList=t.data.filter(t=>"Creado"!==t.estadoArticuloNombre),this.assignedPaperList=this.paperList.filter(t=>{if(console.log(void 0===t.evaluadores[0].nombre),void 0===t.evaluadores[0].nombre)return{idEval1:t.evaluadores[0].id,idEval2:t.evaluadores[1].id,idEval3:t.evaluadores[2].id,idArticulo:t.idArticulo,nombreArticulo:t.nombreArticulo}}),this.showAssignedPaperList=this.assignedPaperList.slice()})}getEvaluators(){this.evaluatorService.getEvaluatorsGroup().subscribe(t=>{this.evaluatorList=t.data})}selectOption1(t,i){this.assignedPaperList=this.assignedPaperList.map(a=>(i.idArticulo===a.idArticulo&&(a.idEval2!==+t&&a.idEval3!==+t?a.idEval1=+t:(alert("Evaluador ya asignado en este mismo paper"),i.idEval1=null)),a))}selectOption2(t,i){this.assignedPaperList=this.assignedPaperList.map(a=>(i.idArticulo===a.idArticulo&&(a.idEval1!==+t&&a.idEval3!==+t?a.idEval2=+t:(alert("Evaluador ya asignado en este mismo paper"),i.idEval2=null)),a))}selectOption3(t,i){this.assignedPaperList=this.assignedPaperList.map(a=>(i.idArticulo===a.idArticulo&&(a.idEval2!==+t&&a.idEval1!==+t?a.idEval3=+t:(alert("Evaluador ya asignado en este mismo paper"),i.idEval3=null)),a))}distributeEvaluators(){this.assignedPaperList=this.assignedPaperList.map(t=>{if(void 0===t.idEval1){let i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;for(;i===t.idEval2||i===t.idEval3;)i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;t.idEval1=i}if(void 0===t.idEval2){let i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;for(;i===t.idEval1||i===t.idEval3;)i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;t.idEval2=i}if(void 0===t.idEval3){let i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;for(;i===t.idEval1||i===t.idEval2;)i=this.evaluatorList[Math.floor(Math.random()*this.evaluatorList.length)].idEvaluador;t.idEval3=i}return t})}post(){this.assignedPaperList.filter(t=>{if(void 0!==t.idEval1&&void 0!==t.idEval2&&void 0!==t.idEval3)return t;void 0===t.idEval1&&void 0===t.idEval2&&void 0===t.idEval3||alert(`El articulo ${t.nombreArticulo} no contiene los 3 evaluadores. No ser\xe1 cargado hasta que la carga sea completa`)}),this.loading=!0,setTimeout(()=>{this.loading=!1},3e3),this.toastr.show("\xbfEst\xe1 seguro que desea asignar las evaluaciones?","\xbfConfirmar asignaciones?",{toastComponent:n.a,disableTimeOut:!0,tapToDismiss:!1,enableHtml:!0}).onAction.subscribe(()=>{this.evaluatorService.postEvaluatorMassive(this.assignedPaperList).subscribe(t=>{this.toastr.success("Los Evaluadores han sido cargado con \xe9xito. Les llegar\xe1 un mail de notificaci\xf3n"),this.router.navigateByUrl("/control")})})}search(t){this.showAssignedPaperList=t}}return t.\u0275fac=function(i){return new(i||t)(r.Mb(l.a),r.Mb(s.a),r.Mb(c.d),r.Mb(o.b))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-asignar-paper-evaluador-list"]],decls:28,vars:5,consts:[[1,"container-fluid"],[1,"contenidos"],[1,"text-center"],[1,"row","p-2","justify-content-end"],["role","button",1,"btn","btn-primary","btn-block","col-md-2",3,"click"],["type","button","class","btn btn-primary btn-block col-md-2",4,"ngIf"],["class","btn btn-primary btn-block col-md-2","role","button",3,"click",4,"ngIf"],[1,"row"],[1,"col-md-5",3,"fullList","attribFilter","listEvent"],[1,"table","text-center","table-hover","table-bordered"],[1,"thead"],[1,"col-md-3"],[1,"col-md-2"],["class","align-items-center",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","btn-block","col-md-2"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"align-items-center"],[1,"col-sm-12"],["name","eval",1,"form-control",3,"change"],["hidden","",3,"selected"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"]],template:function(t,i){1&t&&(r.Rb(0,"div",0),r.Rb(1,"div",1),r.Nb(2,"hr"),r.Rb(3,"h3",2),r.Jc(4,"Asignar art\xedculos a Evaluadores"),r.Qb(),r.Nb(5,"hr"),r.Qb(),r.Nb(6,"br"),r.Rb(7,"div",3),r.Rb(8,"a",4),r.bc("click",function(){return i.distributeEvaluators()}),r.Jc(9,"Asignaci\xf3n Masiva"),r.Qb(),r.Jc(10," \xa0 "),r.Hc(11,u,4,0,"button",5),r.Hc(12,v,2,0,"a",6),r.Qb(),r.Rb(13,"div",7),r.Rb(14,"app-search",8),r.bc("listEvent",function(t){return i.search(t)}),r.Qb(),r.Qb(),r.Rb(15,"table",9),r.Rb(16,"thead",10),r.Rb(17,"tr"),r.Rb(18,"th",11),r.Jc(19,"Art\xedculo"),r.Qb(),r.Rb(20,"th",12),r.Jc(21,"Evaluador 1"),r.Qb(),r.Rb(22,"th",12),r.Jc(23,"Evaluador 2"),r.Qb(),r.Rb(24,"th",12),r.Jc(25,"Evaluador 3"),r.Qb(),r.Qb(),r.Qb(),r.Rb(26,"tbody"),r.Hc(27,m,21,7,"tr",13),r.Qb(),r.Qb(),r.Qb()),2&t&&(r.Ab(11),r.lc("ngIf",i.loading),r.Ab(1),r.lc("ngIf",!i.loading),r.Ab(2),r.lc("fullList",i.assignedPaperList)("attribFilter",i.nombreArticulo),r.Ab(13),r.lc("ngForOf",i.showAssignedPaperList))},directives:[e.o,d.a,e.n,b.k,b.q],styles:[".container-fluid[_ngcontent-%COMP%]{background-color:#f4f4f4}.contenidos[_ngcontent-%COMP%]{padding-bottom:3rem}.thead[_ngcontent-%COMP%]{background-color:#c8e5f1}.greyned[_ngcontent-%COMP%]{color:grey}.btn-primary[_ngcontent-%COMP%]{background-color:#3cafe0;border:none}i[_ngcontent-%COMP%]{padding-top:1.5rem;cursor:pointer}i[_ngcontent-%COMP%]:hover{color:blue}.fa[_ngcontent-%COMP%], .fas[_ngcontent-%COMP%]{font-size:1.25rem;color:#00609c}hr[_ngcontent-%COMP%]{border:1px solid #00609c}@media (min-width:768px){hr[_ngcontent-%COMP%]{margin-left:25%;margin-right:25%}.container-fluid[_ngcontent-%COMP%]{padding:5rem}}"]}),t})();const f=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=r.Gb({type:t,selectors:[["app-asignar-paper-evaluador"]],decls:1,vars:0,template:function(t,i){1&t&&r.Nb(0,"app-asignar-paper-evaluador-list")},directives:[E],styles:[""]}),t})()}];let L=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({imports:[[o.d.forChild(f)],o.d]}),t})();var A=a("pKmL");let Q=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({imports:[[e.c,L,A.a]]}),t})()}}]);